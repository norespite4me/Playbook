---
banner:
banner: "![[Cybersecurity-Banner-700-2203920168.jpg]]"
banner_y: 0.352
---
Tags: [[Ethical Hacking]] [[Notes]]
# Module 3 -- Information Gathering and Vulnerability Scanning
## 3.1 – Performing Passive Reconnaissance
### 3.1.2 – Active Recon vs Passive Recon
**Active recon** - method of finding information using tools that send out probes to the target network or systems in order to elicit responses that are then used to determine the posture of the network or system
**Passive recon** - method of gathering information gathering where the tools do not interact directly with the target device or network
- there are many methods of passive recon
	- using third party databases to gather info
	- use tools to prevent detection
**Common Active Recon Tools**
- host enumeration
- network enumeration
- user enumeration
- group enumeration
- network share enumeration
- web page enumeration
- application enumeration
- packet crafting
**Common Passive Recon Tools/Methods**
- domain enumeration
- packet inspection
- open-source intelligence (OSINT)
- Recon-ng
- Eavesdropping
### 3.1.5 – DNS Lookups
While a burglar may take a look around the house and make note of all the doors and windows, a cyber attacker would perform tasks like scanning and enumeration
- Nmap is a tool that was once considered a simple port scanner, but has evolved into a robust tool thanks to the Nmap Scripting Engine (NSE)
There are other tools as well, such as **nslookup**, **host**, and **dig**
- dig obtains information about a given domain
	- dig < domain > mx
		- obtain the email servers used by that domain
### 3.1.10 – Cloud vs Self-Hosted Applications and Related Subdomains
A company can own a domain and related subdomain
- application may be hosted in the cloud
- so some IPv4 addresses may belong to other companies, where one company is using the other to host their services
	- for example, Netflix has Amazon host their servers
### 3.1.11 – Social Media Scraping
People post way too much about themselves online, and threat actors can use that to their advantage
- look for key contact at companies and research what their job responsibilities are
- leverage job listings on sites like Indeed, LinkedIn, etc
- Some hackers create job posts to attract people for these positions and then essentially interrogate the applicants
### 3.1.13 – Cryptographic Flaws
**Certificate Transparency** – the goal is for any organization or individual to be able to “transparently” verify the issuance of a digital certificate
- can use this transparency to learn more information and enumerate subdomains
### 3.1.15 – Company Reputation and Security Posture
Attackers leverage password dumps from previous breaches
- people often reuse passwords
**Strategic Search Engine Analysis/Enumeration**
- filetype
	- directs google to search oly within the text of a particular type of file
- inurl
	- direct google to search only within the specified URL
- link
	- direct google to search within hyperlinks
- intitle
	- directs google to search for a term within the title
**Website Archiving/Caching**
- wayback  machine
	- access content that may no longer be available
**Public Source Code Repos**
- amateur coders will often have vulnerabilities in their code that attackers can take advantage of
### 3.1.20 – Open-Source Intelligence (OSINT) Gathering
**Recon-ng**
- developed by Tim Tomes of Black Hills Information Security
	- modular framework
	- social network enumeration
## 3.2 – Performing Active Recon
**Active Recon**
- gather information about target
- enumeration
**Port Scans**
- active scan in which the scanning tool sends various types of probes to the target IP address and then examines the responses to determine whether the service is actually listening

| Nmap Port Status Reported | Response From Target                                    | Nmap Analysis                            |
| ------------------------- | ------------------------------------------------------- | ---------------------------------------- |
| Open                      | TCP SYN-ACK                                             | The service is listening on the port     |
| Closed                    | TCP RST                                                 | The service is not listening on the port |
| Filtered                  | No response from target or ICMP destination unreachable | The port is firewalled                   |
### 3.2.2 – Nmap Scan Types
**TCP Connext Scan**
- A TCP Connect scan actually makes use of the OSes networking mechanism to establisha  full TCP connection with the device being scanned

| Nmap Port Status Reported | Response from Target        | Nmap Analysis                    |
| ------------------------- | --------------------------- | -------------------------------- |
| Open                      | TCP SYN-ACK                 | service is listening on port     |
| Closed                    | TCP RST                     | service is not listening on port |
| Filtered                  | No response from the target | port is firewalled               |
- full TCP connect scan requires the scanner to send an additional packet per scan, which increases network activity
**UDP Scan (-sU)**
- usually will be scanning TCP instead
- scan UDP for enumerating
	- DNS
	- SNMP
	- DHCP

| Nmap Port Status Reported | Response from Target         | Nmap Analysis                            |
| ------------------------- | ---------------------------- | ---------------------------------------- |
| Open                      | Data returned from port      | The service is listening on the port     |
| Closed                    | ICMP error message received  | the service is not listening on the port |
| Open/filtered             | no ICMP response from target | the port is firewalled or timed out      |
![[Pasted image 20250728160319.png]]
**TCP FIN Scan (-sF)**
- two times when a SYN scan might be picked up by a network filter or firewall

| Nmap Port Status Reported | Response from Target            | Nmap Analysis                       |
| ------------------------- | ------------------------------- | ----------------------------------- |
| Filtered                  | ICMP unreachable error received | closed port should respond with RST |
| Closed                    | RST packet received             | closed port should respond with RST |
| Open/Filtered             | No response received            | open port should drop FIN           |
**Host Discover Scan (-sn)**
- most common type of scan to enumerate hosts
	- can use different types of ICMP messages to determine whether a host is online and responding on a network
**Timing Options (-T 0-5)**
- nmap scanner provides six timing templates
	- 0 (paranoid) – very slow, used for IDS evasion
	- 1 (sneaky) – quite slow, used for IDS evasion
	- 2 (polite) – slows down to consume less bandwidth, runs about 10 times slower than default
	- 3 (normal) – default, a dynamic timing model based on target responsiveness
	- 4 (aggressive) – assumes a fast and reliable network and may overwhelm targets
	- 5 (insane) – very aggressive; will likely overwhelm targets or miss open ports
### 3.2.4 – Types of Enumeration
**Host Enumeration**
- internal and external
- externally, you want IP address you’re scanning to just the scope of the test
**User Enumeration**
- gathering valid list of users is imperative in cracking credentials
	- can brute force if you have username
- performed when you have gained access to the internal network
**Group Enumeration**
- helpful in determining the authorization roles that are being use in the target environment
**Network Share Enumeration**
- identifies systems on a network that are sharing files
- nmap –script smb-enum-shares.nse -p 445 < host >
**Additional SMB Enumeration Examples**
- nmap -sC runs the most common NSE scripts based on the ports found to be open on the target system
**Web Page Enumeration/Web Application Enumeration**
- once identified web server that is running on target host, can look at web app and map out attack surface with web page enumeration or web application enumeration
- nmap -sV –script=http-enum < target >
- nikto is aother web enumeration tool
**Service Enumeration**
- process of identifying the services running on a remote system, and primary focus of what Nmap does as a port scanner
**Exploring Enumeration via Packet Crafting**
- when it comes to enumeration via packet crafting and generation, Scapy is one of the pentesters’ favorite tools and frameworks
- scapy supports a large number or protocols
## 3.3 – Understanding the Art of Performing Vulnerability Scans
### 3.3.2 – How a Typical Automated Vulnerability Scanner Works
**Step 1 – Discovery Phase**
- scanner uses a tool such as Nmap to perform host and port enumeration
- using results of port enumeration, scanner begins to probe on open ports for more info
**Step 2**
- when scanner has obtained enough info about open port to determine what software and version are running on that port, it records that information in a database for further analysis
**Step 3**
- the scanner tries to determine if the software that is listening on the target system is susceptible to any known vulnerabilities
**Step 4**
- Scanner produces a report on what it suspects could be vulnerable
- often false positives and need to be validated
### 3.3.4 – Types of Vulnerability Scans
- unauthenticated scans
- authenticated scans
- discovery scans
- full scans
- stealth scans
- compliance scans

**Unauthenticated Scans**
- vulnerability scanners normally do not use credentials to scan a target
- provide IP address of target, tool will begin enumerating host from the perspective of an unauthenticated remote attacker
	- shows only the network services that are exposed to the network
**Authenticated Scans**
- sometimes it’s best to run an authenticated scan to get a full picture of the attack surface
- require credentials with root-level access to the system
- netstat
**Discovery Scans**
- identifies the attack surface of a target
- port scan is a major part of what a discovery scan performs
- Nmap
**Full Scans**
- involves enabling every scanning option in the scan policy
	- options vary based on scanner
**Stealth Scans**
- scan without alerting the defensive position of the environment
**Compliance Scan**
- network and application tests typically driven by the market or governance that the environment serves and regulatory compliance
- challenging because there are so many types for differing industries and government agencies
### 3.3.7 – Challenges to Consider When Running a Vulnerability Scan
**Considering the Best Time to Run a Scan**
- most concern when scanning prod network
	- network traffic that is being generated by a vulnerability scan can and will cause a lot of noise on the network
	- can cause congestion, esp when scans are traversing multiple network hops
	- scans can crash the network
- scan at times where there is least impact on users
**Determining What Protocols Are in Use**
- one of the first things you need to know about a network are what protocols are being used
- if target device is using both TCP and UDP and you only run against TCP, then you’re potentially missing any vulnerabilities that might be found on the UDP services
**Network Topology**
- should always be considered when it comes to vuln scanning
	- should be scanned as close to target as possible
	- any device you traverse can potentially affect your scan and give you inconclusive results
**Bandwidth Limitations**
- need to be aware how your scanning affects the bandwidth of the network
**Query Throttling**
- can slow down traffic of your scanner to help prevent negatively affecting the stability of the network
**Fragile Systems/Nontraditional Assets**
- must take into consideration the devices on the network that might not be able to stand up to the traffic of a vulnerability scanner
	- printers are fragile
	- can exempt specific devices from the scan so that they aren’t rekt
## 3.4 – Understanding How to Analyze Vulnerability Scan Results
### 3.4.2 – Sources for Further Investigation of Vulnerabilities
**US-CERT**
- US Computer Emergency Readiness Team
- established to protect the internet infrastructure of the US
	- work with puublic and private-sector agencies to increase the efficiency of vulnerability data sharing
**The CERT Division of Carnegie Mellon University**
- expert who help coordinate vulnerability disclosures aacross the industry
**NIST**
- National Institute of Standards and Technology
- agency of the US Dept of Commerce
- responsible for the NIST Cybersecurity Framework (CSF)
- assist organizations in assessing the risks they encounter
**JPCERT**
- Japan Computer Emergency Response Team
- works with service providers, security vendors, and private-sector and government agencies to provide incident response capabilities
- responsible for Computer Security Incident Response Team (CSIRT) activities in the Japanese and Asia Pacific region
**CAPEC**
- Common Attack Pattern Enumeration and Classification
- community-driven effert to catalog the attack partterns seen in the wild
- maintained by MITRE
**CVE**
- Common Vulnerabilities and Exposure
- effort that reaches across international cyber communities
- CVE ID is composed of the letters CVE followed by the year of publication and four or more digits in the sequence and number portion of the ID
**CWE**
- Common Weakness Enumeration
- list of softrware weaknesses
- create common language to describe software security weaknesses
**CVSS**
- Common Vulnerability Scoring System
- three components of the score
	- base
		- represents the intrinsic characteristics of a vulnerability that are constant over time and do not depend on a user-specific environment
		- scored between 0 and 10
		- explotability metrics that measure how the vulnerability can be exploited as well as inmpact metrics that measure the impac on confidentiality, integrity, and availability
	- temporal
	- environmental
### 3.4.4 – How to Deal with a Vulnerability
**Must Answer These Questions**
- What is the severity of the vulnerability?
- How many systems does the vulnerability apply to?
- How was the vulnerability detected?
- Was the vulnerability found with an automated scanner or manually?
- What is the value of the device on which the vulnerability was found?
- Is this device critical to your business or infrastructure?
- What is the attack vector, and does it apply to your environment?
- Is there a possible workaround or mitigation available?